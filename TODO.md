### TODO List

- Server
  - 0Byte recv를 받았을 경우(높은 확률로 연결 종료로 인한), session의 ptr을 가지고 있는 모든 객체에서의 일관된 소멸 처리
  - PingPongGameBullet
    - 갱신 시간 tick 및 해당 위치 정보 2가지를 멤버 변수로 추가하기
    - 최초 Bullet의 생성
      - Bullet의 종류, 위치, 속도 (정확히는, 방향과 속력 2가지 정보), 마지막 충돌한 player (최초, -1로 설정)를 가짐
      - S_P_Bullet이라는 이름의 패킷으로 직렬화하여 해당 Object가 생성됨을 BroadCast
    - Bar에 의한 충돌의 구현
      - 해당 Player Bar를 소유한 Client가 충돌했다고 패킷을 보냄.
      - Client에게 로직을 온전히 맡기는 것은 상당히 위험하다. 따라서 해당 충돌이 유효한지 검사하는 방어책이 필요.
      - 충돌 발생시, `갱신시의 위치` + `(현재시간 - 갱신시간) * (Bullet의 속도)` 에 해당하는 값이 충돌지점과 일치하는지 (정확히는 충돌지점과의 거리가 일정 torr값 이하인지) 판정.
      - 실제로는 ping에 의해서 정확히 같은 값이 나올 수가 없음. 다만, 1m이상 차이가 난다고 하면 분명히 이상하다. (Ping이 비정상적으로 높거나.. `그거`임)
      - 또한, 특정 플레이어 Bar의 위치는, 제한된 위치에 존재할 수 밖에 없음. 해당 위치를 크게 벗어나면 유효하지 않은 충돌로 간주.
      가령 서쪽문 수호자의 경우 playerBar의 위치는 X = 6.4 로 고정이고, -3.2 < Z < 3.2 임. 이 값을 크게 벗어난 경우, `그거`임.
      - 위의 과정에 따라 유효한 충돌이라고 판단되는 경우, 위치와 시간을 갱신하고 충돌한 player의 type에 따라 x 혹은 z 속도값을 반전.
      - 마지막으로 충돌한 playerid를 기록. 해당 player가 다시 충돌했다고 주장한 경우 무시. (중복 충돌 방지)
      - 해당 결과를 S_P_Bullet으로서 전송.
        - 클라이언트에서는 해당 objectId를 가진 Bullet이 없는 경우, 새로 생성. 있는 경우 존재하는 Object의 값을 갱신
  - PingPongPlayerGoalLine
    - Line에 충돌한 경우 해당 Player의 점수를 깎음.
    - Bar에 의한 충돌이 발생한 경우. `갱신시의 위치` + `Bullet의 속도 직선방향`의 GoalLine을 계산.
    해당 Object의 충돌 없이, 해당 Player의 감점이 일어나지 않은 경우 부정한 방법을 사용중일 가능성에 대한 계산 가능하지만
    시간관계상 이 부분은 패스. 전적으로 Client를 믿는 방법으로 진행....

- Client
  - 최초 접속 시에, 접속할 서버의 IP주소를 입력하도록 하기 (마크처럼)
  - PlayerBar
    - 현재 다른 PlayerBar의 위치가 Update문을 통해 특정 주기(현재 66ms)마다 Broadcast되어진다.
    - 해당 패킷 핸들러를 통한 변화가 급작스럽게 표현되기 때문에, Lerp를 통해 PlayerBar의 이동을 부드럽게 표현할 필요가 있음.
  - PingPongGameBullet
    - Bar에 의한 충돌 구현
      - OnTrigger옵션을 이용하여, Bar와 충돌한 Object, 그 Object의 속력, 이동방향을 직렬화하여 전송.
      - 사실 그 object의 속도와 이동방향의 경우 Server에서도 가지고 있는 값이다..
      굳이 전송할 필요는 없지만 일단 같이 전송하고 테스트를 통해 확실히 필요없다고 판단되는 경우 패킷에서 제외하려고 함.
  - PingPongPlayerGoalLine
    - OnTrigger 옵션을 이용하여, Line에 Object가 충돌한 경우. 실점.

- DB
  - CountingState가 구현될 때 까지 할 일 없음.
  - 별도의 기기에서 실행하기.

---

### 현재 우선순위

- 미니게임 추가하기
- 인게임 로직 완성하기
